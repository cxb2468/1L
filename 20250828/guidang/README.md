# 桌面文件自动归档工具

一个功能强大的桌面文件自动归档工具，支持Word、Excel、PowerPoint、PDF等文档的自动归档管理。

## 功能特性

### 🗂️ 文件管理
- **智能扫描**: 自动扫描桌面上的Office文档（Word、Excel、PowerPoint、PDF等）
- **灵活归档**: 支持按日期、文件类型、大小等规则进行归档
- **安全操作**: 支持移动或复制模式，确保文件安全
- **冲突处理**: 智能处理文件名冲突，自动重命名

### ⏰ 定时任务
- **多种频率**: 支持按小时、天、周、月执行归档任务
- **灵活调度**: 可设置具体的执行时间
- **任务管理**: 支持启动、停止、暂停、恢复调度
- **手动执行**: 随时可以手动触发归档操作

### 🎨 用户界面
- **直观GUI**: 基于tkinter的现代化图形界面
- **实时监控**: 显示文件扫描状态和归档进度
- **系统托盘**: 支持后台运行，系统托盘快速访问
- **配置管理**: 可视化的设置界面，支持配置导入导出

### 📊 日志系统
- **详细记录**: 记录所有归档操作和系统事件
- **多级日志**: 支持调试、信息、警告、错误等级别
- **日志查看**: 内置日志查看器，支持搜索和过滤
- **自动清理**: 自动清理过期日志文件

### 🔧 高级功能
- **配置备份**: 自动备份和恢复配置
- **统计信息**: 提供详细的归档统计数据
- **通知提醒**: 系统托盘通知归档结果
- **错误恢复**: 支持从归档中恢复文件

## 安装和使用

### 方式一：直接运行exe文件（推荐）

1. 下载最新的exe文件
2. 双击运行即可启动
3. 首次运行会自动创建配置文件

### 方式二：从源码运行

1. **克隆项目**
   ```bash
   git clone <项目地址>
   cd guidang
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **运行程序**
   ```bash
   python main.py
   ```

### 方式三：自行打包

1. **安装打包依赖**
   ```bash
   pip install pyinstaller
   ```

2. **创建图标**
   ```bash
   python create_icon.py
   ```

3. **打包exe**
   ```bash
   python build_exe.py
   ```

## 使用指南

### 首次设置

1. **启动程序**: 双击exe文件或运行Python脚本
2. **配置路径**: 设置桌面路径和归档目标路径
3. **选择文件类型**: 选择要归档的文件类型
4. **设置调度**: 配置自动归档的时间和频率
5. **开始监控**: 点击"开始监控"启动自动归档

### 主界面功能

- **文件监控区域**: 显示当前扫描到的文件列表
- **归档设置**: 配置归档规则和目标路径
- **调度设置**: 设置定时任务的执行频率
- **日志显示**: 查看归档操作的详细日志
- **手动归档**: 立即执行一次归档操作

### 系统托盘

程序支持最小化到系统托盘，提供以下功能：
- 显示/隐藏主窗口
- 立即执行归档
- 打开设置
- 查看关于信息
- 退出程序

## 配置说明

### 基本配置

```json
{
  "desktop_path": "C:\\Users\\用户名\\Desktop",
  "archive_path": "C:\\Users\\用户名\\Documents\\归档文件",
  "file_types": [".docx", ".xlsx", ".pptx", ".pdf"],
  "archive_mode": "move",
  "schedule_enabled": true,
  "schedule_frequency": "daily",
  "schedule_time": "18:00"
}
```

### 高级配置

- **archive_mode**: 归档模式（"move"移动，"copy"复制）
- **min_file_age_hours**: 文件最小年龄（小时），避免归档正在使用的文件
- **max_file_size_mb**: 最大文件大小限制（MB）
- **organize_by_date**: 是否按日期组织归档目录
- **organize_by_type**: 是否按文件类型组织归档目录

## 目录结构

```
guidang/
├── main.py                 # 主程序入口
├── modules/                # 核心模块
│   ├── __init__.py
│   ├── file_scanner.py     # 文件扫描器
│   ├── archive_manager.py  # 归档管理器
│   ├── config_manager.py   # 配置管理器
│   ├── scheduler.py        # 任务调度器
│   ├── logger.py          # 日志系统
│   └── system_tray.py     # 系统托盘
├── requirements.txt        # 依赖包列表
├── create_icon.py         # 图标创建工具
├── build_exe.py          # exe打包工具
├── app_icon.ico          # 应用程序图标
└── README.md             # 项目说明
```

## 技术栈

- **GUI框架**: tkinter（Python内置）
- **任务调度**: schedule库
- **系统托盘**: pystray库
- **图像处理**: Pillow库
- **系统信息**: psutil库
- **打包工具**: PyInstaller

## 系统要求

- **操作系统**: Windows 7/8/10/11
- **Python版本**: 3.7+（如果从源码运行）
- **内存**: 最少128MB可用内存
- **磁盘空间**: 最少50MB可用空间

## 常见问题

### Q: 程序无法启动？
A: 请检查是否有杀毒软件阻止，或者尝试以管理员身份运行。

### Q: 文件归档失败？
A: 请检查目标路径是否有写入权限，以及文件是否被其他程序占用。

### Q: 系统托盘图标不显示？
A: 可能是pystray库未正确安装，请重新安装依赖包。

### Q: 定时任务不执行？
A: 请确保程序保持运行状态，并检查调度设置是否正确。

### Q: 如何恢复误归档的文件？
A: 可以在日志中查看归档记录，手动将文件移回原位置，或使用程序的恢复功能。

## 更新日志

### v1.0.0
- 初始版本发布
- 基本的文件扫描和归档功能
- GUI界面和系统托盘支持
- 定时任务调度
- 配置管理和日志系统

## 许可证

本项目采用MIT许可证，详见LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进这个项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至开发者

---

**注意**: 使用本工具前请备份重要文件，开发者不对数据丢失承担责任。